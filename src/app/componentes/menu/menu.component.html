<ion-header class="header">
  <ion-toolbar>
    <ion-title class="titulo-menu" id="titulo-menu">Platos principales</ion-title>
    <ion-buttons slot="end">
      <!-- Botón para toggle motion -->
      <ion-button (click)="toggleMotion()" [color]="motionEnabled ? 'success' : 'medium'" fill="solid">
        <ion-icon [name]="motionEnabled ? 'phone-portrait' : 'phone-portrait-outline'" slot="icon-only"></ion-icon>
      </ion-button>
      
      <ion-button *ngIf="tieneMesaAsignada" (click)="irAConsultaMozo()" color="primary" fill="solid">
        <ion-icon name="chatbubbles-outline" slot="start"></ion-icon>
        Consultar Mozo
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content class="container-prods">
  <!-- Indicador de movimiento -->
  <div class="motion-indicator" *ngIf="showMotionIndicator" [@fadeIn]>
    {{ motionIndicatorText }}
  </div>


  @for(plato of platos; track plato; let i = $index){
    <ion-card class="container-plato" [class.producto-activo]="productoActualIndex === i">
      <swiper-container #swiperContainer pagination="true" class="bebida-swiper">
        @for(foto of plato.imagenes; track foto){
          <swiper-slide>
            <img [src]="foto" [alt]="plato.nombre + 'foto'" class="bebida-image" />
          </swiper-slide>
        }
      </swiper-container>

      <ion-card-header>
        <ion-card-subtitle class="precio-destacado">{{plato.precio | currency}}</ion-card-subtitle>
        <ion-card-title class="plato-nombre">{{plato.nombre}}</ion-card-title>
      </ion-card-header>

      <ion-card-content class="descripcion">
        {{plato.descripcion}}
      </ion-card-content>
      <ion-card-content class="descripcion" style="color: red;">
        Tiempo de elaboracion: <span style="font-weight: bold;">{{plato.tiempo_elaboracion}} minutos</span> 
      </ion-card-content>

      <!-- NUEVO: Control de cantidad -->
      <div class="control-cantidad-container">
        <!-- Estado inicial: Botón Agregar -->
        <ion-button 
          *ngIf="obtenerCantidadProducto(plato.id) === 0"
          class="boton-agregar-inicial"
          expand="block" 
          fill="solid" 
          color="primary"
          (click)="agregarAlCarrito(plato)">
          <ion-icon name="add-outline" slot="start"></ion-icon>
          Agregar
        </ion-button>

        <!-- Estado con items: Control +/- -->
        <div *ngIf="obtenerCantidadProducto(plato.id) > 0" class="control-cantidad">
          <button class="btn-cantidad btn-menos" (click)="restarProducto(plato)">
            <ion-icon name="remove-outline"></ion-icon>
          </button>
          
          <span class="cantidad-actual">
            {{obtenerCantidadProducto(plato.id)}}
          </span>
          
          <button class="btn-cantidad btn-mas" (click)="agregarAlCarrito(plato)">
            <ion-icon name="add-outline"></ion-icon>
          </button>
        </div>
      </div>

    </ion-card> 
  }
  
  @for(bebida of bebidas; track bebida; let i = $index){
    <ion-card class="container-plato" [class.producto-activo]="productoActualIndex === (platos.length + i)">
      <swiper-container #swiperContainer pagination="true" class="bebida-swiper">
        @for(imagen of bebida.imagenes; track imagen){
          <swiper-slide>
            <img [src]="imagen" [alt]="bebida.nombre + ' foto 1'" class="bebida-image" />
          </swiper-slide>
        }
      </swiper-container>

      <ion-card-header>
        <ion-card-subtitle class="precio-destacado">{{bebida.precio | currency}}</ion-card-subtitle>
        <ion-card-title class="plato-nombre">{{bebida.nombre}}</ion-card-title>
      </ion-card-header>

      <ion-card-content class="descripcion">
        {{bebida.descripcion}}
      </ion-card-content>
      <ion-card-content class="descripcion" style="color: red;">
        Tiempo de elaboracion: <span style="font-weight: bold;">{{bebida.tiempo_elaboracion}} minutos</span> 
      </ion-card-content>

      <!-- NUEVO: Control de cantidad tipo PedidosYa -->
      <div class="control-cantidad-container">
        <!-- Estado inicial: Botón Agregar -->
        <ion-button 
          *ngIf="obtenerCantidadProducto(bebida.id) === 0"
          class="boton-agregar-inicial"
          expand="block" 
          fill="solid" 
          color="primary"
          (click)="agregarAlCarrito(bebida)">
          <ion-icon name="add-outline" slot="start"></ion-icon>
          Agregar
        </ion-button>

        <!-- Estado con items: Control +/- -->
        <div *ngIf="obtenerCantidadProducto(bebida.id) > 0" class="control-cantidad">
          <button class="btn-cantidad btn-menos" (click)="restarProducto(bebida)">
            <ion-icon name="remove-outline"></ion-icon>
          </button>
          
          <span class="cantidad-actual">
            {{obtenerCantidadProducto(bebida.id)}}
          </span>
          
          <button class="btn-cantidad btn-mas" (click)="agregarAlCarrito(bebida)">
            <ion-icon name="add-outline"></ion-icon>
          </button>
        </div>
      </div>

    </ion-card> 
  }
  <div class="barra-spacer"></div>
  <!-- Barra flotante del carrito -->
  <div class="barra-carrito-flotante" *ngIf="totalItems() > 0">
    <div class="barra-contenido">
      <div class="barra-info">
        <span class="cantidad-items">{{totalItems()}} items</span>
        <span class="precio-total">{{totalPrecio() | currency}}</span>
      </div>
      <ion-button 
        class="boton-ver-carrito"
        fill="solid" 
        color="primary"
        (click)="irAlCarrito()">
        <ion-icon name="cart-outline" slot="start"></ion-icon>
        Ver Carrito
      </ion-button>
    </div>
  </div>
</ion-content>













  <!-- <div class="container-plato">   PRIMER ESTILO QUE HABIA HECHO TIPO MENU PEDIDOS YA
    <div class="info-plato">
      <h3 class="titulo-plato">Hamburguesa California</h3>
      <p class="descripcion-plato">Hamburguesa completa con doble carne, cheddar, panceta y cebolla caramelizada</p>
      <h2 class="precio">$ 18.000</h2>
    </div>
    <div class="imagen">
      <img src="https://media.istockphoto.com/id/1473452859/es/foto/sabrosa-hamburguesa-con-queso-vaso-de-cola-y-papas-fritas-en-primer-plano-de-bandeja-de-madera.jpg?s=612x612&w=0&k=20&c=cz14RIorGJFn3mFhBFL66PqvXD1nYC_28Cc_OO4mhps=" alt="hamburguesa">
    </div>
  </div> -->

<!-- <ion-header class="header">
  <ion-toolbar>
    <ion-title class="titulo-menu" id="titulo-menu">Platos principales</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content class="container-prods">
  @for(plato of platos; track plato){
    <ion-card  class="container-plato">
      <swiper-container 
        
        pagination="true" 
        class="bebida-swiper"
      >
        @for(foto of plato.imagenes; track foto){
          <swiper-slide>
            <img [src]="foto" [alt]="plato.nombre + 'foto'" class="bebida-image" />
          </swiper-slide>
        }
      </swiper-container>

      <ion-card-header>
        <ion-card-subtitle class="precio-destacado">{{plato.precio | currency}}</ion-card-subtitle>
        <ion-card-title class="plato-nombre">{{plato.nombre}}</ion-card-title>
      </ion-card-header>

      <ion-card-content class="descripcion">
        {{plato.descripcion}}
      </ion-card-content>
    </ion-card> 
  
  }
  @for(bebida of bebidas; track bebida){
    <ion-card class="container-plato">
      
      <swiper-container 
        
        pagination="true" 
        class="bebida-swiper"
      >
        @if(bebida.foto1){
          <swiper-slide>
            <img [src]="bebida.foto1" [alt]="bebida.nombre + ' foto 1'" class="bebida-image" />
          </swiper-slide>
        }
        @if(bebida.foto2){
          <swiper-slide>
            <img [src]="bebida.foto2" [alt]="bebida.nombre + ' foto 2'" class="bebida-image" />
          </swiper-slide>
        }
        @if(bebida.foto3){
          <swiper-slide>
            <img [src]="bebida.foto3" [alt]="bebida.nombre + ' foto 3'" class="bebida-image" />
          </swiper-slide>
        }
      </swiper-container>

      <ion-card-header>
        <ion-card-subtitle class="precio-destacado">{{bebida.precio | currency}}</ion-card-subtitle>
        <ion-card-title class="plato-nombre">{{bebida.nombre}}</ion-card-title>
      </ion-card-header>

      <ion-card-content class="descripcion">
        {{bebida.descripcion}}
      </ion-card-content>
    </ion-card> 
  }
</ion-content>  MENU QUE ESTA BIEN -->











<!-- <ion-header>   CODIGO BUENO
  <ion-toolbar>
    <ion-title>Bebidas</ion-title>
  </ion-toolbar>
</ion-header>


@for(bebida of bebidas; track bebida){
   <ion-card>
    <img alt="imagen-producto" [src]="bebida.foto1" />
    <ion-card-header>
      <ion-card-subtitle class="precio-destacado" >{{bebida.precio | currency}}</ion-card-subtitle>
      <ion-card-title>{{bebida.nombre}}</ion-card-title>
    </ion-card-header>

    <ion-card-content>
      {{bebida.descripcion}}
    </ion-card-content>
  </ion-card> 

} -->